#!/usr/bin/python
# vim: noet sw=4 ts=4

import	os
import	sys
import	__main__

def	use_my( relative_to, p ):
	where = os.path.abspath(
		os.path.join(
			relative_to,
			p
		)
	)
	# print >>sys.stderr, 'Prepending "%s".' % where
	sys.path.insert(
		0,
		where
	)
	return


try:
	# This hopscotch lets us run from the development directory
	# and is ignored if run from an installed place.
	here = os.path.abspath(
		os.path.expanduser(
			__main__.__file__
		)
	)
	# print >>sys.stderr, 'here=%s' % here
	if here.startswith( os.getenv( 'HOME' ) ):
		# Non-root install
		use_my(
			os.path.join(
				here,
				'..',		# Directory holding script "bin/"
				'..'		# Directory above "../bin/"
			),
			'lib/python%d.%d/site-packages' % (
				sys.version_info[ 0 ],
				sys.version_info[ 1 ]
			)
		)
		# In-situ usage
		use_my(
			here,
			'src'
		)
	try:
		import	__init__ as gpp
	except:
		import	gpp
except Exception, e:
	print >>sys.stderr, 'Cannot locate gpp'
	print >>sys.stderr, 'Module path:'
	for path in sys.path:
		print >>sys.stderr, '+-- %s' % path
	print >>sys.stderr, e
	raise e

pp = gpp.GenericPrettyPrinter()
exit( pp.main() )
